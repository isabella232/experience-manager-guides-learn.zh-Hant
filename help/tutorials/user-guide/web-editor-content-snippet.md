---
title: 從您的資料來源插入內容片段
description: 在AEM Guides中使用來自您資料來源的資料。 瞭解如何從您的資料來源插入內容片段。 使用主題產生器建立主題。
exl-id: 9d60499c-49b4-4793-b3ec-5c99b34338e0
source-git-commit: e8503e1441b7bc365d37c76ab9cf7b5f50374f10
workflow-type: tm+mt
source-wordcount: '2029'
ht-degree: 0%

---

# 使用來自您的資料來源的資料

A **資料來源** 是您儲存和管理組織資料的系統。 這些是您的記錄系統，例如JIRA、SQL資料庫、PIM或PLM。 AEM Guides提供可連線您的資料來源及使用來自這些來源之資料的功能。

## 資料來源面板

選取 **資料來源** ![](images/data-source-icon.svg) 以檢視連線的資料來源。 「資料來源」面板隨即開啟並顯示所有連線的資料來源。

根據您的設定，管理員可以設定資料來源聯結器：

<details>
<summary> 雲端服務 </summary>


- 如果您使用2023年10月版或更新版本，瞭解如何 [從使用者介面設定資料來源聯結器](../cs-install-guide/conf-data-source-connector-tools.md) 在Cloud Service安裝與設定指南中。

- 如果您使用2023年7月或2023年9月版本，瞭解如何 [設定資料來源聯結器](../cs-install-guide/conf-data-source-connector.md) 在Cloud Service安裝與設定指南中。

</details>

<details>    
<summary>  內部部署軟體 </summary>

瞭解如何 [設定資料來源聯結器](../install-guide/conf-data-source-connector.md)  ，位於On-premise安裝與設定指南中。
</details>


>[!NOTE]
>
> 您將會看到管理員已設定聯結器的資料來源。


## 顯示清單檢視或平鋪檢視

您可以在「清單檢視」或「並排檢視」之間切換，以清單形式或並排方式檢視各種資料來源。

選取資料來源以檢視所選資料來源可用的內容片段產生器和主題產生器。

### 清單檢視  ![](images/data-sources-list-view-icon.svg)

![](images/data-sources-list-view.png){width="300" align="left"}

*連線的資料來源清單。*

### 平鋪檢視   ![](images/data-sources-tile-view-icon.svg)

![](images/data-sources-tile-view.png){width="300" align="left"}

*以圖磚檢視連線的資料來源。*

資料來源資料有兩種使用方式：
- 插入內容片段
- 建立主題



## 從您的資料來源插入內容片段

AEM Guides提供與您的資料來源連線的功能。 您可以擷取資料、將其插入主題並進行編輯。 您可以使用內容片段產生器輕鬆建立內容片段，並在主題中重複使用。

執行以下步驟，使用內容片段產生器建立內容片段並插入您的主題中：

1. 選取 **資料來源** ![](images/data-source-icon.svg)   以檢視連線的資料來源。

1. 選取資料來源，以檢視可用於所選資料來源的內容片段產生器。

   ![](images/code-snippet-generator.png){width="300" align="left"}
   *「資料來源」面板會列出可用的內容片段產生器。*

1. 選取 **新增** 以新增內容片段產生器。 此 **新增內容片段產生器** 面板隨即開啟。

1. 在「資料查詢」文字方塊中輸入查詢。
1. 從以下位置選擇與您的資料來源對應的範本： **資料對應範本** 下拉式清單。
所選資料來源的現成範本會顯示在下拉式清單中。 例如，您可以檢視名為「PostgreSQL」資料來源的「sql-table」範本。

   >[!NOTE]
   >  
   > 如果管理員已設定自訂範本，則您也會在下拉式清單中顯示這些範本（根據管理員完成的範本路徑設定）。
   >   
   >您也可以在範本中使用Velocity工具。 進一步瞭解如何 [使用Velocity工具](#use-velocity-tools).

1. 按一下 **擷取** 從資料來源擷取資料，並將範本套用至從SQL查詢產生的資料。

1. 您可以在預覽或DITA來源檢視中檢視資料。

   1. 預覽會顯示資料插入內容時的顯示方式。 預覽會以所選範本的格式顯示資料的一小部分。
例如：
      - 如果您已選取sql表格範本，則可以使用表格格式檢視SQL資料。
      - 如果您已選取Jira排序清單範本，則可檢視Jira問題的排序清單。

   1. 來源檢視會顯示DITA來源檢視中的資料。
      ![](images/add-content-snippet-generator.png){width="800" align="left"}
      *新增內容片段產生器。 在來源或預覽模式中檢視資料。*

1. 若要儲存查詢的結果，請輸入產生器的名稱，然後按一下 **新增**.   新的內容片段產生器已新增至清單中。

   >[!NOTE]
   >
   > 您必須遵循新內容產生器名稱的檔案命名慣例。 內容片段產生器的名稱中不能有空格。 此外，您無法使用現有內容產生器的名稱儲存新的內容產生器。 發生錯誤。

### 內容片段產生器的選項

以滑鼠右鍵按一下內容片段產生器，開啟「選項」。 您可以使用這些選項執行下列操作：

- **預覽**：使用此選項可開啟窗格並檢視資料在輸出中顯示的少量方式。
- **插入**：使用此選項可將選取的內容片段插入在網頁編輯器中開啟供編輯的主題中。 當資料以片段形式插入時，您也可以在Web編輯器中編輯主題中的資料。

  >[!NOTE]
  > 
  > 只有在編輯主題時，才會顯示插入選項。

- **編輯**：使用此選項來變更內容片段產生器並儲存。
- **刪除**：使用此選項可刪除選取的內容片段產生器。
- **複製**：使用此選項可建立所選內容片段產生器的重複或副本。 根據預設，會以尾碼（如generator_1）建立副本。

### 插入查詢程式碼片段

您也可以使用 **插入查詢代碼片段** ![](images/data-source-icon.svg)   將資料片段插入主題。  您可以從下拉式清單中選取產生器、編輯查詢，或變更範本並將資料插入主題中。

![](images/insert-content-snippet.png){width="800" align="left"}

*編輯並插入資料片段。*

## 使用主題產生器建立主題

主題產生器可協助您建立包含來源資料的主題。 您可以快速建立主題產生器，然後使用該產生器產生主題。 每個主題都可以包含各種格式的資料，例如表格、清單和段落。   例如，在主題中，您可以新增一個表格，其中包含所有新產品的詳細資訊以及將會停止銷售的所有產品清單。

主題產生器可針對所有主題建立包含資料和DITA map的主題。 您也可以 `<conref>` 這些主題在您的內容中。 這可協助您將資料與資料來源保持同步，並且您可以輕鬆更新資料。



### 建立主題

執行以下步驟，使用主題產生器建立主題：

1. 選取資料來源以檢視所選資料來源可用的內容片段產生器和主題產生器。

   ![](images/data-sources.png){width="300" align="left"}

   *為連線的資料來源新增主題產生器。*

1. 選取 **新增** ![](images/Add_icon.svg) 並選取 **主題產生器** 從下拉式清單中新增主題產生器。 此 **新增主題產生器** 面板隨即開啟。



1. 在欄位的下列三個標籤下輸入值 **新增主題產生器** 面板：

   **擷取設定**

   ![](images/topic-generator-fetch-configuration.png){width="300" align="left"}

   *新增主題產生器的資料查詢、資料對應範本和根節點詳細資訊，並在「擷取設定」面板中為其指定唯一名稱。*

   1. 在 **資料查詢** 文字方塊。
   1. 從以下位置選擇與您的資料來源對應的範本： **資料對應範本** 下拉式清單。

      >[!NOTE]
      >
      > 如果管理員已設定自訂範本，則您也會在下拉式清單中顯示這些範本（根據管理員完成的範本路徑設定）。 例如，您可以建立包含排序清單、表格、段落或其他DITA元素的主題範本。

   1. 輸入 **根節點**. 這是您要存取資料的節點。 然後，主題產生器在根節點中定義的層級建立每個主題。 例如，您可以在Jira中新增「問題」作為根節點。 因此，如果查詢傳回13個問題，您將獲得13個主題，每個問題一個主題。

   1. 按一下 **擷取** 從資料來源擷取資料，並將範本套用至從SQL查詢產生的資料。 預覽會顯示主題以所選範本格式顯示的一小部分。 例如，您可以檢視單一Jira問題，其中包含查詢產生的所有欄位。
   1. 輸入主題產生器的名稱。

      >[!NOTE]
      > 
      > 您必須遵循新主題產生器名稱的檔案命名慣例。 主題產生器的名稱中不能有空格。 此外，您無法使用現有主題產生器的名稱儲存新的主題產生器。 發生錯誤。

   **輸出設定**

   ![](images/topic-generator-output-configuration.png){width="300" align="left"}

   *在「輸出組態」面板中，輸入輸出路徑和主題命名慣例的詳細資訊。 產生DITA map並加以命名。*

   1. 輸入 **輸出路徑** 您想要儲存主題的詳細資訊。
   1. 在 **主題命名慣例**，您可以輸入值或具有velocity標籤的變數。 新主題將遵循慣例。 例如，您可以輸入 `$key` 以根據Jira鍵建立主題。
   1. 啟用選項 **產生地圖** 如果要建立包含所有產生之主題的貼圖。
   1. 輸入新DITA map的名稱。

   >[!NOTE]
   >
   > 主題產生器會在與主題相同的輸出路徑上產生DITA map。

   **中繼資料**

   從下拉式清單中選取中繼資料屬性，以傳遞至主題。 **名稱** 下拉式清單會同時列出自訂和預設屬性。

   例如，在下列熒幕擷圖中， `dc:description`， `dc:language`， `dc:title`、和 `docstate` 是預設屬性，您可為其定義值。 您可以建立自訂屬性（如author）並定義其值。

   ![](images/topic-generator-metadata.png){width="300" align="left"}

   *在中繼資料面板中新增中繼資料屬性，以傳遞至主題。*

1. 輸入產生器的名稱，然後按一下 **儲存** 以儲存查詢結果。 新的主題產生器已新增至清單中。

1. 按一下 **儲存並產生** 儲存主題產生器並從主題產生器產生新主題。



   ![](images/edit-topic-generator.png){width="650" align="left"}

   *從現有主題產生器產生新主題。*

   >[!NOTE]
   >
   > 如果主題已經存在，則產生器會更新現有主題中的資料。

### 主題產生器的選項

在主題產生器上按一下滑鼠右鍵以開啟 **選項**. 您可以使用這些選項執行下列操作：

- **產生**：此選項會產生所選主題產生器的主題。 您也可以使用此選項來更新現有的主題。 它會連線至資料來源並擷取更新的資料。 產生內容時，此選項會停用，而且您會檢視載入器。
  >[!NOTE]
  >
  >如果您的主題已經存在，您可以覆寫主題中的資料，或將其儲存為新版本。

  ![](images/generate-topic-options.png)

  *產生主題，如果檔案已存在，請將其儲存為新版本或覆寫它。*
- **檢視記錄**：選取此選項可檢視內容產生記錄檔。 日誌檔案會在新標籤中開啟。 您可以在記錄檔中檢視錯誤、警告、資訊訊息和例外。 如果您已產生所選主題產生器的內容，則會啟用此選項。

- **預覽**：使用此選項可開啟窗格並檢視資料在輸出中顯示的少量方式。



- **編輯**：使用此選項來變更和儲存主題產生器。 產生內容時，此選項會停用。
- **刪除**：使用此選項可刪除選取的主題產生器。 產生內容時，此選項會停用。
- **複製**：此選項會建立所選主題產生器的重複或副本。 重複專案是以尾碼建立(例如 `topic-sample_1`)預設情況下。



## 在資料來源範本中使用Velocity工具 {#use-velocity-tools}

Experience Manager範本也支援Velocity工具（2.0版）。 這些工具可協助您將各種功能套用至從資料來源擷取的資料。 進一步瞭解如何使用 [Velocity工具](https://velocity.apache.org/tools/2.0/generic.html) 以及可套用的功能。

若要在範本中使用「速度」工具，請執行下列步驟：
1. 在網頁編輯器中編輯Velocity範本。
1. 在中新增工具及其功能 `<tool.function>` 格式。 例如：
   - 若要使用數學工具產生隨機數字，請使用 `$mathTool.random`.
   - 若要使用數學工具產生數字總和，請使用 `$mathTool.add(num1, num2)`.
1. 使用範本建立內容片段或主題。
1. 將範本套用至資料後，您可以在預覽或DITA來源檢視中檢視資料。




您可以在Velocity範本內使用下列工具，將各種功能套用至您從聯結器擷取的資料： -`$alternatorTool`
- `$classTool`
- `$contextTool`
- `$conversionTool`
- `$dateTool`
- `$comparisonDateTool`
- `$displayTool`
- `$escapeTool`
- `$fieldTool`
- `$loopTool`
- `$linkTool`
- `$listTool`
- `$mathTool`
- `$numberTool`
- `$renderTool`
- `$resourceTool`
- `$sortTool`
